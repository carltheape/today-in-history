<!DOCTYPE html>
<html>
<head>
<link href="https://fonts.googleapis.com/css?family=Amatic+SC" rel="stylesheet">
<style type="text/css">

*{
  font-family: 'Amatic SC', cursive;
  font-weight: 900;
}
  h1{
    display: inline;
  }
  
  
  #list{
    font-size: 24px;
  }
  
  #img > img{
    height: 50px;
  }
  
  #weather{
    position: relative;
    text-align: center;
    font-size: 24px;
  }  
  
  #weather-content{
    border: solid 5px lightgrey;
    height: 200px;
    width: 200px;
    border-radius: 50%;
    position: relative;
    text-align: center;
    margin: auto;
    box-shadow: 13px 13px 49px 5px rgba(0,0,0,0.26); 
  }
  
  .temps{
    position: absolute;
    top: 20%;
    left: 10%;
    width: 50%;
  }
  
  #img{
    position: absolute;
    top: 15%;
    left: 40%;
    width: 50%;
  }
  
  #feels{
    position: absolute;
    bottom: 35%;
    width: 100%;
  }
  
  #condition{
    position: absolute;
    bottom: 20%;
    width: 100%;
  }
  
  #hi{
    color: red;
  }
  
  #lo{
    color: blue;
  }
  
</style>
  <meta charset="UTF-8">
  <title></title>
</head>
<body>
  <div class="history">
    <h1>Today is </h1>
    <h1 id="date"></h1>
  	<h2>
  		Today in History:
  	</h2>
  	<ul id="list">
  		
  	</ul>
  </div>
  <div id="weather">
    <h2>
      Atlanta's Weather today
    </h2>
    <div id="weather-content">
      <div class="temps">
        <div id="hi">
          High:
        </div>
        <div id="lo">
          Low:
        </div>
      </div>
    <div id="img">
      
    </div>
    <div id="feels">
      Feels Like:
    </div>
    <div id="condition">
      
    </div>
    </div>
  </div>
  <div class="test">
    
  </div>
</body>

<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
  
<script>
var today = new Date();
//Get today's date

var month = new Array();
month[0] = "January";
month[1] = "February";
month[2] = "March";
month[3] = "April";
month[4] = "May";
month[5] = "June";
month[6] = "July";
month[7] = "August";
month[8] = "September";
month[9] = "October";
month[10] = "November";
month[11] = "December";
//define the months of the year

var n = month[today.getMonth()];
//grab the month for today

let ev = [];
// console.log(n+"_"+today.getDate());

$('#date').html(n+" "+today.getDate());
//put today's month and day on the page

function item() { return ev[Math.floor(Math.random()*ev.length)]};
//this will grab one random event for today's date

$.getJSON('http://allorigins.me/get?url=' + encodeURIComponent("https://en.wikipedia.org/wiki/" + n + "_" + today.getDate() + "") + '&callback=?', function(data){
// console.log(data.contents);
//go get the events for today's date using 

    var el = $( '<div></div>' );
    el.html(data.contents);
    //stick the response in an div

    let events = $('#Events', el).parent().next()[0];
    //find the Events portion of the response and grab the correct parent that holds all the data

    console.log(events.children);
    // console.log(events.children.length);
    //these are the individual events

    for (var i = 0; i < events.children.length; i++) {
    	ev.push(events.children[i].innerText);
    }
    //convert them all into an array to use easier


    $('#list').html(item());
    //stick in an item for the first time

    // console.log(item);
    
    
    $.getJSON('http://allorigins.me/get?url=' + encodeURIComponent("https://www.wunderground.com/weather/us/ga/atlanta") + '&callback=?', function(data){
      // console.log(data.contents);
      
      var el = $( '<div></div>' );
      el.html(data.contents);
      let weather = $('.city-conditions', el);
      console.log(weather[0]);
      let hi = $('.hi', weather[0]);
      let lo = $('.lo', weather[0]);
      let pic = $('img', weather[0]);
      let picLink = pic[0].attributes[1].nodeValue;
      let feels = $('.temp', weather[0]);
      let conditionHolder = $('.condition-icon', weather[0]);
      let condition = $('p', conditionHolder);
      $('#hi').append(hi);
      $('#lo').append(lo);
      $('#img').html(`<img src="http:${picLink}">`);
      $('#feels').append(feels[0].innerHTML);
      $('#condition').append(condition[0].innerHTML);
      // $('.test').html(weather[0]);
      // console.log(condition[0].innerHTML);
      
    });

});

$(function() {
    history();

    function history() {
       setTimeout(history,10000);
       $('#list').html(item());
       //a recursive callback loop that will display a different event every 10 seconds
    }
});
	
</script>
</html>